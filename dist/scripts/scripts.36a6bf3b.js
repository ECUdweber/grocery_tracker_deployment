"use strict";angular.module("angularGroceryTrackerApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ui.sortable"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl"}).when("/about",{templateUrl:"views/about.html",controller:"AboutCtrl"}).when("/detail",{templateUrl:"views/detail.html",controller:"DetailCtrl"}).when("/create-shopping-list",{templateUrl:"views/manage-list.html",controller:"ManageListCtrl"}).when("/manage-grocery-items",{templateUrl:"views/manage-grocery-items.html",controller:"ManageGroceryItemsCtrl"}).when("/manage-list/:listId",{templateUrl:"views/manage-list.html",controller:"ManageListCtrl"}).when("/edit-grocery-item/:itemId",{templateUrl:"views/edit-grocery-item.html",controller:"EditGroceryItemCtrl"}).when("/use-list/:listId",{templateUrl:"views/use-list.html",controller:"UseListCtrl"}).otherwise({redirectTo:"/"})}]),angular.module("angularGroceryTrackerApp").controller("MainCtrl",["$scope","$location","$http","listsFactory",function(a,b,c,d){a.shoppingLists=[],a.addToDo=function(){a.todos.push(a.todo),a.todo=""},a.removeToDo=function(b){a.todos.splice(b,1)},a.refresh=function(){a.shoppingLists=d.query()},a.removeList=function(b){d["delete"]({id:b},function(b){a.refresh()})},a.useList=function(a){b.path("/use-list/"+a)},a.editList=function(a){b.path("/manage-list/"+a)},a.refresh()}]),angular.module("angularGroceryTrackerApp").controller("AboutCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("angularGroceryTrackerApp").controller("DetailCtrl",["$scope",function(a){a.awesomeThings=["HTML5 Boilerplate","AngularJS","Karma"]}]),angular.module("angularGroceryTrackerApp").controller("ManageGroceryItemsCtrl",["$scope","$location","$http","itemsFactory",function(a,b,c,d){a.item={name:"",price:""},a.items=[],a.addGroceryItem=function(){a.item.name&&""!==a.item.name&&d.save(a.item,function(b){a.refresh()})},a.deleteItem=function(b){d["delete"]({id:b},function(b){a.refresh()})},a.editItem=function(a){b.path("/edit-grocery-item/"+a)},a.refresh=function(){a.items=d.query(),a.item={name:"",price:""}},a.refresh()}]),angular.module("angularGroceryTrackerApp").controller("ManageListCtrl",["$scope","$location","$routeParams","$http","listsFactory","itemsFactory",function(a,b,c,d,e,f){a.currentListId=c.listId,a.newItem="-1",a.availableItems=[],a.item={},a.removeItemFromList=function(b){a.list.items.splice(b,1)},a.addItemToListFromDropdown=function(){a.list.items.push(angular.fromJson(a.newItem,1)),a.newItem=-1},a.saveList=function(){a.currentListId?e.update({id:a.currentListId},a.list):e.save(a.list),b.path("/#")},a.updateAvailableItems=function(){a.availableItems=f.query()},a.addItemToList=function(){a.list.items.push(a.item),f.save(a.item),a.updateAvailableItems(),a.item={}},a.list=a.currentListId?e.get({id:a.currentListId}):{name:"",use_count:0,items:[]},a.updateAvailableItems()}]),angular.module("angularGroceryTrackerApp").controller("EditGroceryItemCtrl",["$scope","$location","$routeParams","$http","itemsFactory",function(a,b,c,d,e){a.item={},a.itemId=c.itemId,a.refresh=function(){a.item=e.get({id:a.itemId})},a.saveGroceryItem=function(){e.update({id:a.itemId},a.item),b.path("/manage-grocery-items")},a.refresh()}]),angular.module("angularGroceryTrackerApp").controller("UseListCtrl",["$scope","$location","$routeParams","$http","listsFactory",function(a,b,c,d,e){a.list={},a.listId=c.listId,a.recipient="-1",a.contact={},a.emailInfo={name:"",listId:a.listId,email:""},a.contacts=[{id:1,name:"Daniel",email:"daniel@bitlathe.com"},{id:2,name:"Tanya",email:"td@thedanielweber.com"}],a.refresh=function(){a.list=e.get({id:a.listId},function(b){a.total=_(b.items).chain().map(function(a){return a.price-0}).reduce(function(a,b){return a+b},0).value(),a.emailInfo.list=b.items})},a.updateRecipient=function(){var b=angular.fromJson(a.recipient,1);a.emailInfo.email=b.email,a.emailInfo.name=b.name},a.sendLink=function(){d.post("/senditems",a.emailInfo),a.list.use_count++,e.update({id:a.listId},a.list)},a.refresh()}]),angular.module("angularGroceryTrackerApp").factory("listsFactory",["$resource",function(a){return a("/shoppinglists/:id",{id:"@id"},{update:{method:"PUT"}})}]).factory("itemsFactory",["$resource",function(a){return a("/items/:id",{id:"@id"},{update:{method:"PUT"}})}]);